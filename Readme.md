# ğŸš€[LEVEL2 P_stage ê¸€ì ê²€ì¶œ ëŒ€íšŒ] ì–¸ì œì˜¤ë¥´ì¡°
![image](https://user-images.githubusercontent.com/59071505/168423013-c7314b24-8fe1-45cb-a5a3-61d05873f43f.png)

&nbsp; 
## ğŸ”¥ Member ğŸ”¥
<table>
  <tr height="125px">
    <td align="center" width="120px">
      <a href="https://github.com/kimkihoon0515"><img src="https://avatars.githubusercontent.com/kimkihoon0515"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ed-kyu"><img src="https://avatars.githubusercontent.com/ed-kyu"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/GwonPyo"><img src="https://avatars.githubusercontent.com/GwonPyo"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ysw2946"><img src="https://avatars.githubusercontent.com/ysw2946"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/jsh0551"><img src="https://avatars.githubusercontent.com/jsh0551"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/YJ0522771"><img src="https://avatars.githubusercontent.com/YJ0522771"/></a>
    </td>

  </tr>
  <tr height="70px">
    <td align="center" width="120px">
      <a href="https://github.com/kimkihoon0515">ê¹€ê¸°í›ˆ_T3019</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ed-kyu">ê¹€ìŠ¹ê·œ_T3037</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/GwonPyo">ë‚¨ê¶Œí‘œ_T3072</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ysw2946">ìœ ìŠ¹ìš°_T3130</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/jsh0551">ì¥ìˆ˜í˜¸_T3185</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/YJ0522771">ì¡°ìœ ì§„_T3208</a>
    </td>
  </tr>
</table>

&nbsp; 
## ğŸ”Project Overview

ìŠ¤ë§ˆíŠ¸í°ìœ¼ë¡œ ì¹´ë“œë¥¼ ê²°ì œí•˜ê±°ë‚˜, ì¹´ë©”ë¼ë¡œ ì¹´ë“œë¥¼ ì¸ì‹í•  ê²½ìš° ìë™ìœ¼ë¡œ ì¹´ë“œ ë²ˆí˜¸ê°€ ì…ë ¥ë˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ë˜ ì£¼ì°¨ì¥ì— ë“¤ì–´ê°€ë©´ ì°¨ëŸ‰ ë²ˆí˜¸ê°€ ìë™ìœ¼ë¡œ ì¸ì‹ë˜ëŠ” ê²½ìš°ë„ í”íˆ ìˆìŠµë‹ˆë‹¤. ì´ì²˜ëŸ¼ OCR (Optimal Character Recognition) ê¸°ìˆ ì€ ì‚¬ëŒì´ ì§ì ‘ ì“°ê±°ë‚˜ ì´ë¯¸ì§€ ì†ì— ìˆëŠ” ë¬¸ìë¥¼ ì–»ì€ ë‹¤ìŒ ì´ë¥¼ ì»´í“¨í„°ê°€ ì¸ì‹í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê¸°ìˆ ë¡œ, ì»´í“¨í„° ë¹„ì „ ë¶„ì•¼ì—ì„œ í˜„ì¬ ë„ë¦¬ ì“°ì´ëŠ” ëŒ€í‘œì ì¸ ê¸°ìˆ  ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.

OCR taskëŠ” ê¸€ì ê²€ì¶œ (text detection), ê¸€ì ì¸ì‹ (text recognition), ì •ë ¬ê¸° (Serializer) ë“±ì˜ ëª¨ë“ˆë¡œ ì´ë£¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤. ë³¸ ëŒ€íšŒëŠ” ì•„ë˜ì™€ ê°™ì€ íŠ¹ì§•ì´ ìˆìŠµë‹ˆë‹¤.

&nbsp;

## â—Competitioin_rules
- ë³¸ ëŒ€íšŒì—ì„œëŠ” 'ê¸€ì ê²€ì¶œ' task ë§Œì„ í•´ê²°
  
- **Input** : ê¸€ìê°€ í¬í•¨ëœ ì „ì²´ ì´ë¯¸ì§€
- **Output** : bbox ì¢Œí‘œê°€ í¬í•¨ëœ UFO Format
- ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ì¸ EAST ëª¨ë¸ì´ ì •ì˜ë˜ì–´ ìˆëŠ” ì•„ë˜ íŒŒì¼ë“¤ì€ ë³€ê²½ì‚¬í•­ ì—†ì´ ê·¸ëŒ€ë¡œ ì´ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
    - model.py
    - loss.py
    - east_dataset.py
    - detect.py

- í‰ê°€ë°©ë²• : Deteval
  1) ëª¨ë“  ì •ë‹µ/ì˜ˆì¸¡ë°•ìŠ¤ë“¤ì— ëŒ€í•´ì„œ Area Recall, Area Precisionì„ ë¯¸ë¦¬ ê³„ì‚°í•´ëƒ…ë‹ˆë‹¤.
  2) ëª¨ë“  ì •ë‹µ ë°•ìŠ¤ì™€ ì˜ˆì¸¡ ë°•ìŠ¤ë¥¼ ìˆœíšŒí•˜ë©´ì„œ, ë§¤ì¹­ì´ ë˜ì—ˆëŠ”ì§€ íŒë‹¨í•˜ì—¬ ë°•ìŠ¤ ë ˆë²¨ë¡œ ì •ë‹µ ì—¬ë¶€ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤.
  3) ëª¨ë“  ì´ë¯¸ì§€ì— ëŒ€í•˜ì—¬ Recall, Precisionì„ êµ¬í•œ ì´í›„, ìµœì¢… F1-Scoreì€ ëª¨ë“  ì´ë¯¸ì§€ ë ˆë²¨ì—ì„œ ì¸¡ì • ê°’ì˜ í‰ê· ìœ¼ë¡œ ì¸¡ì •ë©ë‹ˆë‹¤.

&nbsp;

## ğŸ—‚ï¸Dataset
- Upstage_data : 1288 images
  
- ICDAR17_MLT : 9000 images
- ICDAR19_MLT : 10000 images
- Aihub OCR : more or less 5000 images

&nbsp;

## ğŸ§±Structure
â”œâ”€â”€ code  
â”‚Â Â  â”œâ”€â”€ model.py  
â”‚Â Â  â”œâ”€â”€ loss.py  
â”‚Â Â  â”œâ”€â”€ east_dataset.py  
â”‚Â Â  â”œâ”€â”€ dataset.py  
â”‚Â Â  â”œâ”€â”€ train.py  
â”‚Â Â  â”œâ”€â”€ inference.py  
â”‚Â Â  â”œâ”€â”€ detect.py  
â”‚Â Â  â”œâ”€â”€ deteval.py  
â”‚Â Â  â”œâ”€â”€ convert_mlt.py  
â”‚Â Â  â”œâ”€â”€ Aihub.py  
â”‚Â Â  â”œâ”€â”€ augmentation.py  
â”‚Â Â  â”œâ”€â”€ split_data.py  
â”‚Â Â  â”œâ”€â”€ OCR_EDA.ipynb  
â”‚Â Â  â”œâ”€â”€ merge_json.ipynb  
â”‚Â Â  â””â”€â”€ requirements.txt  
â””â”€â”€ data

&nbsp;

## ğŸ§ªExperiments
1. Upstage annotation ìˆ˜ì •
   - ìº í¼ë“¤ì´ ì‘ì—…í•œ Upstage imageë“¤ì˜ annotationì´ ì œëŒ€ë¡œ ë˜ì–´ìˆì§€ ì•Šì€ ê²ƒì„ í™•ì¸
   - 1288ì¥ì˜ ì´ë¯¸ì§€ë“¤ì„ ì „ìˆ˜ì¡°ì‚¬í•˜ì—¬ Labelmeë¥¼ í†µí•´ ìˆ˜ì •

    |  | Data | F1 score | recall | precision |
    | --- | --- | --- | --- | --- |
    | ìˆ˜ì • ì „ | ICDAR17_MLT(ko) + upstage data | 0.4517 | 0.3470 | 0.6468 |
    | ìˆ˜ì • í›„ | ICDAR17_MLT(ko) + upstage data | 0.5078 | 0.3938 | 0.7150 |

&nbsp;

2. ICDAR ë°ì´í„°ì˜ ì œì™¸ì˜ì—­ í¬í•¨ ì—¬ë¶€
   - ICDAR ë°ì´í„°ì˜ ê²½ìš°, annotationì˜ ê¸°ì¤€ì´ ê¸°ì¡´ì˜ annotation guideì™€ ìƒë‹¹íˆ ë‹¤ë¥¸ ê²ƒì„ í™•ì¸
   - test dataì˜ ê²½ìš° ê¸°ì¡´ì˜ annotation guideë¥¼ ë”°ë¥¼ê±°ë¼ ìƒê°í•˜ì—¬, ì œì™¸ì˜ì—­ì„ í•™ìŠµì— í¬í•¨

    |  | Data | F1 score | recall | precision |
    | --- | --- | --- | --- | --- |
    | ì œì™¸ì˜ì—­ ë¶ˆí¬í•¨ | ICDAR17_MLT(ko) + ICDAR19_MLT(ko) | 0.5477 | 0.4279 | 0.7608 |
    | ì œì™¸ì˜ì—­ í¬í•¨ | ICDAR17_MLT(ko) + ICDAR19_MLT(ko) | 0.5856 | 0.4712 | 0.7733 |

&nbsp;

3. Augmentation
   - augmentationì´ ì ìš©ëœ ì´ë¯¸ì§€ë¥¼ ì‹œê°í™”í•´ë³´ë©´ì„œ ì ì ˆí•œ augmentation ê¸°ë²•ì„ ì„ ì •
   - ëŒ€íšŒ Base augmentation(flip,rotate,crop)
   - ì´ì™¸ Augmentation(RandomBrightnessContrast, GaussNoise, CLAHE)

    |  | Data | F1 score | recall | precision |
    | --- | --- | --- | --- | --- |
    | Base | ICDAR17_MLT(ko) | 0.4586 | 0.3495 | 0.6664 |
    | Add augmentation | ICDAR17_MLT(ko) | 0.6270 | 0.5241 | 0.7801 |

&nbsp;

4. ë‹¤ì–‘í•œ ë°ì´í„°ì…‹ ë¹„êµ
   - Korean, English ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ì–‘í•œ ì–¸ì–´ë¥¼ í•™ìŠµì— í¬í•¨
   - ìˆ˜ì •í•œ Upstage data, ICDAR19_MLT, Aihub OCR ë°ì´í„°ì…‹ ì‚¬ìš©
  
    |  | Data | F1 score | recall | precision |
    | --- | --- | --- | --- | --- |
    | 1 | ICDAR17_MLT(ko) + upstage data | 0.5078 | 0.3938 | 0.7150 |
    | 2 | ICDAR17_MLT(ko) + upstage data + Aihub(ì‹¤ì œ ì•¼ì™¸ ì´¬ì˜ í•œê¸€ ì´ë¯¸ì§€)| 0.3942 | 0.2896 | 0.6168 |
    | 3 | ICDAR17_MLT(en,ko) + upstage data | 0.5620 | 0.4553 | 0.7338 |
    | 4 | ICDAR17_MLT(all) + upstage data | 0.6717 | 0.5772 | 0.8031 |
    | 5 | ICDAR17_MLT(ko) + ICDAR19_MLT(ko) | 0.5477 | 0.4279 | 0.7608 |
    | 6 | ICDAR19_MLT(Except French) | 0.6719 | 0.5842 | 0.7906 |
    | 7 | ICDAR17_MLT(all) + ICDAR19_MLT(all) + upstage data | 0.6443 | 0.5549 | 0.7682 |


&nbsp;

## ğŸ†Result
- ì´ 19 íŒ€ ì°¸ì—¬
- Public : 13ë“± -> Private : 5ë“±

![image](https://user-images.githubusercontent.com/59071505/168441937-2fdb6476-7554-4208-8abc-386c8d71fafc.png)

&nbsp;
|  | Data | F1 score | recall | precision |
| --- | --- | --- | --- | --- |
| 1 | ICDAR17_MLT + upstage data | 0.6717 -> 0.6596 | 0.5772 -> 0.5778 | 0.8031 -> 0.7685 |
| 2 | ICDAR19_MLT(Except French) | 0.6719 -> 0.6843 | 0.5842 -> 0.6039 | 0.7906 -> 0.7893 |


&nbsp;

## ğŸ’¡Usage
1. Install Requirements
    ```
    pip install -r requirements.txt
    ```

2. Create Dataset
- ê° ë§í¬ì—ì„œ ë°ì´í„° ë‹¤ìš´ë¡œë“œ í›„ ufo ë³€í™˜

  - [ICDAR17](https://rrc.cvc.uab.es/?ch=8&com=downloads), [ICDAR19](https://rrc.cvc.uab.es/?ch=15&com=downloads)
      ```
      python code/convert_mlt.py
      ```
      
  - [Aihub](https://aihub.or.kr/aidata/33985/download)
      ```
      python code/Aihub.py
      ```

3. Merge Dataset
   - image
      - ë³µì‚¬ ë¶™ì—¬ë„£ê¸°ë¥¼ í†µí•´ í•œ ë””ë ‰í† ë¦¬ë¡œ í•©ì¹˜ê¸°
     
   - annotation
       > merge_json.ipynb

4. Train
    ```
    Model : EAST
    optimizer : Adam
    scheduler : MultiStepLR
    epoch : 200
    loss : EAST_Loss(sm_Loss(Dice coefficient) + geo_Loss(IOU,Cosine))
    ```

    ```
    python code/train.py
    ```
